<!DOCTYPE html>
<!--[if lt IE 7 ]> <html class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]>    <html class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]>    <html class="no-js ie8"> <![endif]-->
<!--[if IE 9 ]>    <html class="no-js ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    
      
        <title>General - HyPhy</title>
      
      
      
        <link rel="canonical" href="http://squidfunk.github.io/mkdocs-material/methods/general/">
      
      
        <meta name="author" content="Michael Li">
      
    
    <meta property="og:url" content="http://squidfunk.github.io/mkdocs-material/methods/general/">
    <meta property="og:title" content="HyPhy">
    <meta property="og:image" content="http://squidfunk.github.io/mkdocs-material/methods/general//../../images/logo.svg">
    <meta name="apple-mobile-web-app-title" content="HyPhy">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
      <link rel="apple-touch-icon" href="../../images/logo.svg">
    
    
    <link rel="shortcut icon" type="image/x-icon" href="../../assets/images/favicon.ico">
    <link rel="icon" type="image/x-icon" href="../../assets/images/favicon.ico">
    <style>
      @font-face {
      	font-family: 'Icon';
      	src: url('../../assets/fonts/icon.eot?52m981');
      	src: url('../../assets/fonts/icon.eot?#iefix52m981')
               format('embedded-opentype'),
      		   url('../../assets/fonts/icon.woff?52m981')
               format('woff'),
      		   url('../../assets/fonts/icon.ttf?52m981')
               format('truetype'),
      		   url('../../assets/fonts/icon.svg?52m981#icon')
               format('svg');
      	font-weight: normal;
      	font-style: normal;
      }
    </style>
    <link rel="stylesheet" href="../../assets/stylesheets/application.css">
    <link rel="stylesheet" href="../../assets/stylesheets/index.css">
		<link rel="stylesheet" href="../../assets/stylesheets/styles.css">
    <link rel="stylesheet" href="../../assets/stylesheets/mobile.css">
    
    
      
      
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu+Mono">
      <style>
        body, input {
          font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
        }
        pre, code {
          font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
        }
      </style>
    
    
    <script src="../../assets/javascripts/modernizr.js"></script>
    
  </head>
  
  
  
  <body class=" ">
    
    <div class="backdrop">
      <div class="backdrop-paper"></div>
    </div>
    <input class="toggle" type="checkbox" id="toggle-drawer">
    <input class="toggle" type="checkbox" id="toggle-search">
    <label class="toggle-button overlay" for="toggle-drawer"></label>
    <header class="header">
      <nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="header-title">
        <a href="#">HyPhy
        <br />
        <span class="header-title-light">Hypothesis Testing using Phylogenies</span></a>
      </div>
      
      <div class="mobile-header-title">
        <a href="#">HyPhy</a>
      </div>
    </div>
    <div class="button button-search" role="button" aria-label="Search">
      <label class="toggle-button icon icon-search" title="Search" for="toggle-search"></label>
    </div>
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false">
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
    </header>
    <main class="main">
      
      <div class="drawer">
        <nav aria-label="Navigation">
  
  <a href="/" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="../../images/logo.svg">
        </div>
      
    </div>
  </a>
  <div class="scrollable">
    <div class="wrapper">
      <div class="toc">
        <ul>
          
            <!-- Render sections -->

  <li>
    <a class=""
      title="Home" href="../.." >
      Home
    </a>

    <!-- Expand active pages -->
    
  </li>

          
            <!-- Render sections -->

  <li>
    <a class=""
      title="Installation" href="../../installation/" >
      Installation
    </a>

    <!-- Expand active pages -->
    
  </li>

          
            <!-- Render sections -->

  <li>
    <a class=""
      title="Getting Started" href="../../getting-started/" >
      Getting Started
    </a>

    <!-- Expand active pages -->
    
  </li>

          
            <!-- Render sections -->

  <li>
    <a class=""
      title="Glossary" href="../../glossary/" >
      Glossary
    </a>

    <!-- Expand active pages -->
    
  </li>

          
            <!-- Render sections -->

  <li>
    <a class=""
      title="Resources" href="../../resources/" >
      Resources
    </a>

    <!-- Expand active pages -->
    
  </li>

          
            <!-- Render sections -->

  <li>
    <span class="section">Methods</span>
    <ul>

      <!-- Render pages of section -->
      
        <!-- Render sections -->

  <li>
    <a class="current"
      title="General" href="./" >
      General
    </a>

    <!-- Expand active pages -->
    

      <!--
        The top-level anchor must be skipped if the article contains a h1
        headline, since it would be redundant to the link to the current page
        that is located just above the anchor. Therefore we directly continue
        with the children of the anchor.
      -->
      

      <!-- Render anchors of active page -->
      
        <ul>
          

            <!-- Render anchor -->
            <li class="anchor">
              <a title="MG94xREV Framework" href="#mg94xrev-framework">
                MG94xREV Framework
              </a>
            </li>
          

            <!-- Render anchor -->
            <li class="anchor">
              <a title="Synonymous Rate Variation" href="#synonymous-rate-variation">
                Synonymous Rate Variation
              </a>
            </li>
          
        </ul>
      
    
  </li>

      
        <!-- Render sections -->

  <li>
    <a class=""
      title="Selection" href="../selection-methods/" >
      Selection
    </a>

    <!-- Expand active pages -->
    
  </li>

      
        <!-- Render sections -->

  <li>
    <a class=""
      title="Other" href="../other-methods/" >
      Other
    </a>

    <!-- Expand active pages -->
    
  </li>

      
    </ul>
  </li>

<!-- Render page link -->

          
            <!-- Render sections -->

  <li>
    <span class="section">Tutorials</span>
    <ul>

      <!-- Render pages of section -->
      
        <!-- Render sections -->

  <li>
    <a class=""
      title="v2.3 Quick Start" href="../../tutorials/quickstart/" >
      v2.3 Quick Start
    </a>

    <!-- Expand active pages -->
    
  </li>

      
        <!-- Render sections -->

  <li>
    <a class=""
      title="Using HyPhy to Detect Selection" href="../../tutorials/selection/README/" >
      Using HyPhy to Detect Selection
    </a>

    <!-- Expand active pages -->
    
  </li>

      
    </ul>
  </li>

<!-- Render page link -->

          
        </ul>
      </div>
    </div>
  </div>
</nav>
      </div>
      <article class="article">
        <div class="wrapper">
          <!--------------------------------------------------------------------------------------->

<h2 id="mg94xrev-framework">MG94xREV Framework<a class="headerlink" href="#mg94xrev-framework" title="Permanent link">#</a></h2>
<p>All methods rely, to some extent, on the MG94xREV codon model, a generalized extension of the <a href="https://www.ncbi.nlm.nih.gov/labs/articles/7968485/">MG94 model</a> that allows for a full GTR mutation rate matrix. The MG94xREV <em>transition matrix</em> <strong>Q</strong> (also known as the <em>instantaneous rate matrix</em>), for the substitution from codon <script type="math/tex">i</script> to codon <script type="math/tex">j</script> is given by: </p>
<p>
<script type="math/tex; mode=display">\begin{equation}
q_{ij} = \left\{ 
\begin{array}{rl}
\alpha\theta_{ij}\pi_{j},         &\delta(i,j)=1, AA(i)=AA(j)     \\
\beta\theta_{ij}\pi_{j},          &\delta(i,j)=1, AA(i)\neq AA(j) \\
0,                                 &\delta(i,j)>1                  \\
-\sum_{k \neq i}q_{ik},            & i=j
\end{array} \right.
\end{equation}</script>
</p>
<p>Parameters in this matrix include the following:</p>
<ul>
<li>
<p><strong>The function <script type="math/tex">\boldsymbol{\delta(i,j)}</script></strong> is an indicator function that equals the number of nucleotide differences between codons <script type="math/tex">i</script> and <script type="math/tex">j</script>; for example, <script type="math/tex">\delta(AAA,AAT) = 1</script> and <script type="math/tex">\delta(AAA,CCG) = 3</script>. Like most other codon models, the MG94xREV model considers only single-nucleotide codon substitutions to be instantaneous. </p>
</li>
<li>
<p>
<script type="math/tex">\boldsymbol{AA(i)}</script> refers to the amino-acid encoded by codon <script type="math/tex">i</script>.</p>
</li>
<li>
<p>
<script type="math/tex">\boldsymbol{\alpha}</script> represents the <em>synonymous substitution rate</em> dS, and <script type="math/tex">\boldsymbol{\beta}</script> represents the <em>nonsynonymous substitution rate</em> dN. Hence, <script type="math/tex">dN/dS = \beta/\alpha</script>. We refer to the <script type="math/tex">dN/dS</script> ratio as simply <script type="math/tex">\omega</script>.</p>
</li>
<li>
<p>Together, the mutation model ("REV" component of MG94xREV model) is described by two parameter sets: <script type="math/tex">\boldsymbol{\Theta}</script>, comprised of values <script type="math/tex">\theta_{ij}</script>, and <script type="math/tex">\boldsymbol{\Pi}</script>, comprised of values <script type="math/tex">\pi_{j}</script>. <script type="math/tex">\Theta</script> values are the <em>nucleotide mutational biases</em>, and <script type="math/tex">\Pi</script> are the <em>equilibrium nucleotide frequencies</em>.</p>
</li>
<li>
<p>Not explicitly seen in this model are the <em>equilibrium codon frequencies</em>, denoted <script type="math/tex">\boldsymbol{\hat{\Pi}}</script>. These frequencies are estimated using nine positional nucleotide frequencies for the target nucleotides in each codon substitution. Specifically, HyPhy employs the <a href="http://dx.doi.org/10.1371/journal.pone.0011230">CF3x4</a> frequency estimator, a corrected version of the common F3x4 estimator (introduced in <a href="https://www.ncbi.nlm.nih.gov/pubmed/7968486">Goldman and Yang 1994</a>) which accounts for biases in nucleotide composition induced by stop codons. </p>
</li>
</ul>
<p>Most methods (except FADE, which does not use codon data) will perform a global MG94xREV fit to optimize branch length and nucleotide substitution parameters before proceeding to hypothesis testing. Several methods (FEL, FUBAR, and MEME) additionally pre-fit a GTR nucleotide model to the data, using the estimated parameters as starting values for the global MG94xREV fit, as a computational speed-up. Resulting branch length and nucleotide substitution parameters are subsequently used as initial parameter values during model fitting for hypothesis testing.</p>
<!--------------------------------------------------------------------------------------->

<h2 id="synonymous-rate-variation">Synonymous Rate Variation<a class="headerlink" href="#synonymous-rate-variation" title="Permanent link">#</a></h2>
<p>A key component of HyPhy methods is the inclusion of <em>synonymous rate variation</em>. In other words, dS is allowed to vary across sites and/or branches, depending on the specific method. <a href="https://doi.org/10.1093/molbev/msi232">This paper</a> provides a detailed analysis demonstrating why incorporating synonymous rate variation into positive selection inference is likely beneficial. Importantly, this consideration of synonymous rate variation stands in contrast to methods implemented in, for example, <a href="https://doi.org/10.1093/molbev/msm088">PAML</a> where dS is constrained to equal 1.</p>
			 <!--
          <aside class="copyright" role="note">
            
            Documentation built with
            <a href="http://www.mkdocs.org" target="_blank">MkDocs</a>
            using the
            <a href="http://squidfunk.github.io/mkdocs-material/" target="_blank">
              Michael Li's Custom Theme
            </a>
            theme.
          </aside>
				-->
          
            <footer class="footer">
              
  <nav class="pagination" aria-label="Footer">
    <div class="previous">
      
        <a href="../../resources/" title="Resources">
          <span class="direction">
            Previous
          </span>
          <div class="page">
            <div class="button button-previous" role="button" aria-label="Previous">
              <i class="icon icon-back"></i>
            </div>
            <div class="stretch">
              <div class="title">
                Resources
              </div>
            </div>
          </div>
        </a>
      
    </div>
    <div class="next">
      
        <a href="../selection-methods/" title="Selection">
          <span class="direction">
            Next
          </span>
          <div class="page">
            <div class="stretch">
              <div class="title">
                Selection
              </div>
            </div>
            <div class="button button-next" role="button" aria-label="Next">
              <i class="icon icon-forward"></i>
            </div>
          </div>
        </a>
      
    </div>
  </nav>

            </footer>
          
        </div>
      </article>
      <div class="results" role="status" aria-live="polite">
        <div class="scrollable">
          <div class="wrapper">
            <div class="meta"></div>
            <div class="list"></div>
          </div>
        </div>
      </div>
    </main>
    <script>
      var base_url = '../..';
      var repo_id  = '';
    </script>
    <script src="../../assets/javascripts/application.js"></script>
    
      <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
    
      <script src="../../assets/mathjaxhelper.js"></script>
    
    
      <script>
        (function(i,s,o,g,r,a,m){
          i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||
          []).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;
          m.parentNode.insertBefore(a,m)
        })(window, document,
          'script', 'https://www.google-analytics.com/analytics.js', 'ga');
        /* General initialization */
        ga('create', 'UA-36723568-3', 'mkdocs.org');
        ga('set', 'anonymizeIp', true);
        ga('send', 'pageview');
        /* Track outbound links */
        var buttons = document.querySelectorAll('a');
        Array.prototype.map.call(buttons, function(item) {
          if (item.host != document.location.host) {
            item.addEventListener('click', function() {
              var action = item.getAttribute('data-action') || 'follow';
              ga('send', 'event', 'outbound', action, item.href);
            });
          }
        });
        /* Register handler to log search on blur */
        var query = document.querySelector('.query');
        query.addEventListener('blur', function() {
          if (this.value) {
            var path = document.location.pathname;
            ga('send', 'pageview', path + '?q=' + this.value);
          }
        });
      </script>
    
  </body>
</html>